{% extends 'base.html' %}

{% load common_tags %}

{% block title %}
    Blog
{% endblock %}

{% block body %}
    {% if posts %}
        {% for post in posts %}
            {% url 'blog:post_detail' post_month=post.published_date.month post_day=post.published_date.day post_year=post.published_date.year post_slug=post.slug as post_url %}
            <div class="content-container">
                <h3 class="post-title">
                    <a href="{{ post_url }}">{{ post.title }}</a><br />
                    <small>{{ post.published_date }}</small>
                </h3>

                <p class="post-tags">
                    {% for tag in post.tags.all %}
                        <span class="label label-primary">{{ tag }}</span>
                    {% endfor %}
                </p>

                <p class="post-body">
                    {% autoescape off %}
                        {{ post.text|markdownify|truncatechars_html:750 }}
                    {% endautoescape %}
                </p>

                {% if post.text|length > 500 %}
                    <p class="post-footer">
                        <a href="{{ post_url }}">Read more</a>
                    </p>
                {% endif %}
            </div>
            <br />
        {% endfor %}
    {% else %}
        <div class="content-container">There are no blog posts.</div>
    {% endif %}

    <div class="page-navigation-container">
        <ul class="pagination">
            {% if posts.has_previous %}
                <li><a href="?page={{ posts.previous_page_number }}">Previous</a></li>
            {% endif %}
            {% if posts.has_next %}
                <li><a href="?page={{ posts.next_page_number }}">Next</a></li>
            {% endif %}
        </ul>
    </div>
{% endblock %}